function patch_out = create_weighted_patch_2(patch_d,s_dict,a,hp,hp2)
%% takes a patch vector as input along with the search window dictionary and position of current element in the iteration and returns the weighted and reconstructed patch

h=0.01; %filter parameter

numel = size(s_dict,1);
 weight = zeros(numel,1);

for k = 1:numel
    dist_int = sqrt(sum((patch_d -s_dict(k)).^2));
    weight(k) = exp(-dist_int/h);
end

weight = weight / sum(weight);
s_dict_copy = horzcat(s_dict,weight);
s_dict_copy = sortrows(s_dict_copy,size(s_dict,2));
patch_out =s_dict(1:49,1:9);
end